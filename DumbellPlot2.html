<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dumbell Plot - 35 Categories with 4 Y Values</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }
        .description {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        .chart-container {
            position: relative;
            height: 800px;
            margin: 20px 0;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 20px;
            background: #007acc;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover {
            background: #005a9e;
        }
        .data-summary {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Dumbell Plot Visualization</h1>
        <div class="description">
            Showing 35 X categories, each with 4 Y values
        </div>
        
        <div class="controls">
            <button onclick="toggleGrid()">Toggle Grid</button>
            <button onclick="toggleLines()">Toggle Connecting Lines</button>
            <button onclick="downloadChart()">Download as PNG</button>
            <button onclick="regenerateData()">Regenerate Data</button>
        </div>

        <div class="chart-container">
            <canvas id="dumbellChart"></canvas>
        </div>

        <div class="data-summary" id="dataSummary">
            <!-- Data summary will be populated by JavaScript -->
        </div>
    </div>

    <script>
        // Initialize data
        let chartData = generateData();
        let showGrid = true;
        let showLines = true;

        function generateData() {
            const categories = Array.from({length: 35}, (_, i) => `Category ${i + 1}`);
            const y1 = Array.from({length: 35}, () => Math.random() * 20 + 10);
            const y2 = Array.from({length: 35}, () => Math.random() * 20 + 15);
            const y3 = Array.from({length: 35}, () => Math.random() * 20 + 20);
            const y4 = Array.from({length: 35}, () => Math.random() * 20 + 25);
            
            return { categories, y1, y2, y3, y4 };
        }

        function updateDataSummary() {
            const { y1, y2, y3, y4 } = chartData;
            const summary = document.getElementById('dataSummary');
            summary.innerHTML = `
                <strong>Data Summary (35 categories, 4 Y values each):</strong><br>
                Y1 range: ${Math.min(...y1).toFixed(1)} - ${Math.max(...y1).toFixed(1)}<br>
                Y2 range: ${Math.min(...y2).toFixed(1)} - ${Math.max(...y2).toFixed(1)}<br>
                Y3 range: ${Math.min(...y3).toFixed(1)} - ${Math.max(...y3).toFixed(1)}<br>
                Y4 range: ${Math.min(...y4).toFixed(1)} - ${Math.max(...y4).toFixed(1)}
            `;
        }

        function createDumbellChart() {
            const ctx = document.getElementById('dumbellChart').getContext('2d');
            const { categories, y1, y2, y3, y4 } = chartData;

            // Destroy existing chart if it exists
            if (window.dumbellChartInstance) {
                window.dumbellChartInstance.destroy();
            }

            // Create datasets for each Y value
            const datasets = [
                {
                    label: 'Y1',
                    data: y1,
                    backgroundColor: '#1f77b4',
                    borderColor: '#1f77b4',
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    type: 'scatter'
                },
                {
                    label: 'Y2',
                    data: y2,
                    backgroundColor: '#ff7f0e',
                    borderColor: '#ff7f0e',
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    type: 'scatter'
                },
                {
                    label: 'Y3',
                    data: y3,
                    backgroundColor: '#2ca02c',
                    borderColor: '#2ca02c',
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    type: 'scatter'
                },
                {
                    label: 'Y4',
                    data: y4,
                    backgroundColor: '#d62728',
                    borderColor: '#d62728',
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    type: 'scatter'
                }
            ];

            // Add connecting lines if enabled
            if (showLines) {
                categories.forEach((_, index) => {
                    const lineData = [y1[index], y2[index], y3[index], y4[index]];
                    datasets.push({
                        label: '',
                        data: lineData,
                        borderColor: 'rgba(128, 128, 128, 0.3)',
                        backgroundColor: 'rgba(128, 128, 128, 0.1)',
                        pointRadius: 0,
                        borderWidth: 1,
                        fill: false,
                        tension: 0,
                        type: 'line',
                        showLine: true
                    });
                });
            }

            window.dumbellChartInstance = new Chart(ctx, {
                type: 'scatter',
                data: {
                    labels: categories,
                    datasets: datasets
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Y Values'
                            },
                            grid: {
                                display: showGrid
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'X Categories'
                            },
                            grid: {
                                display: showGrid
                            }
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'Dumbell Plot: Four Y Values for Each X Category',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    if (label) {
                                        return `${label}: ${context.parsed.x.toFixed(2)}`;
                                    }
                                    return '';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Control functions
        function toggleGrid() {
            showGrid = !showGrid;
            createDumbellChart();
        }

        function toggleLines() {
            showLines = !showLines;
            createDumbellChart();
        }

        function downloadChart() {
            const link = document.createElement('a');
            link.download = 'dumbell-plot.png';
            link.href = document.getElementById('dumbellChart').toDataURL();
            link.click();
        }

        function regenerateData() {
            chartData = generateData();
            updateDataSummary();
            createDumbellChart();
        }

        // Initialize the chart and data summary
        document.addEventListener('DOMContentLoaded', function() {
            updateDataSummary();
            createDumbellChart();
        });
    </script>
</body>
</html>
